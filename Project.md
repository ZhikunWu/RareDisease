# 人类X染色体失活
1.X染色体失活逃逸基因

2.X染色体特异性甲基化

Pacbio HiFi + ONT reads, RNA data

---


# 哺乳动物X染色体失活逃逸landscape

## 现在仅有HiFi数据（无甲基化信息），Hi-C数据和RNA数据（二代测序）如何鉴定哺乳动物X染色体失活逃逸landscape

在仅有 **HiFi (无5mC信息)**、**Hi-C** 和 **二代 RNA-seq** 的情况下，鉴定 X 染色体失活逃逸（XCI Escape）的核心逻辑将从“表观修饰”转向 **“等位基因特异性表达 (ASE)”** 与 **“三维空间构象 (3D Architecture)”** 的联合推断。

以下是一套高质量的研究鉴定方案：



### 1. 核心策略：等位基因特异性分析 (Allele-Specific Analysis)

由于你没有甲基化数据，**等位基因特异性表达 (ASE)** 是判断基因是否逃逸的“金标准”。

#### A. 构建单倍型解析的基因组 (Haplotype-resolved Assembly)

* **利用 Hi-C 挂载**：使用 `hifiasm` 的 Hi-C 模式，直接产出物种的两个单倍型（Hap1 & Hap2）组装结果。
* **鉴定 SNP**：在两个单倍型之间识别高质量的 SNP 位点。这些 SNP 是后续区分父/母本来源读段的“锚点”。

#### B. 鉴定逃逸基因：ASE 流程

1. **Read Mapping**：将二代 RNA-seq 读段比对到分相后的参考基因组。
2. **Read Tagging**：使用 `Whatshap haplotag` 或 `GATK ASEReadCounter`。根据 SNP 信息，将每条 RNA 读段分配给对应的单倍型（X1 或 X2）。
3. **计算逃逸指数 (Escape Index)**：
* 在女性/雌性细胞中，绝大多数 X 基因只从一条染色体表达。
* **定义逃逸**：如果某个基因在被判定为“失活 X (Xi)”的染色体上，其表达比例显著超过阈值（通常为总表达量的 10%-25%），则鉴定为逃逸基因。





### 2. 三维基因组特征补充（Hi-C 的妙用）

Hi-C 不仅用于组装，它在 Xi 上有独特的拓扑特征，可以辅助鉴定逃逸。

* **Megadomain 识别**：失活的 X 染色体通常会塌缩成两个由 *DXZ4* 区域分隔的超结构域（Megadomains）。
* **逃逸区域的空间松弛**：
* **TAD 保守性**：失活区域的 TAD 通常会消失，转变为极度压缩的异染色质状态。
* **Escape-TADs**：逃逸基因所在的区域往往会保留或重新形成微小的 **TAD 结构**。通过对比 Xa 和 Xi 的 Hi-C 热图，寻找在 Xi 上依然存在的局部互作信号。


* **A/B Compartment 转换**：逃逸基因通常位于活跃的 **A-compartment** 或处于 A/B 转换的边界，而失活基因则深埋在 **B-compartment** 中。



### 3. 多物种演化约束分析 (Evolutionary Constraint)

既然你有多个物种的数据，这可以极大弥补缺乏甲基化信息的不足：

* **序列同源性比对**：在 100+ 物种中寻找 X 染色体上的共线性区域。
* **演化保守性筛选**：如果一个基因在多个物种中均被鉴定出 ASE（等位基因特异表达）且其上游存在保守的 **CTCF 结合基序**，那么它作为逃逸基因的可信度极高。



### 4. 推荐分析流程 (Bioinformatic Pipeline)

| 步骤 | 目标 | 推荐工具 |
| --- | --- | --- |
| **1. 组装** | 获取单倍型基因组 | `hifiasm --hic` |
| **2. 变异调用** | 寻找区分 X1/X2 的 SNP | `DeepVariant` / `Whatshap` |
| **3. RNA 分相** | 统计等位基因表达量 | `STAR` + `Whatshap haplotag` |
| **4. 空间分析** | 识别 Xi 上的活跃结构域 | `Juicer` / `HiC-Explorer` |
| **5. 统计推断** | 判定逃逸 Landscape | 自定义 Python/R 脚本 (Binomial Test) |



### 5. 课题亮点建议：针对国自然设计

由于缺乏甲基化数据，你可以在标书中强调 **“空间构象对剂量补偿的决定性作用”**：

> **科学假设**：在哺乳动物演化过程中，X 染色体失活逃逸并非零散发生的，而是受 **三维基因组拓扑边界 (TAD Boundaries)** 约束的。
> **创新点**：结合高质量 HiFi 组装带来的精准单倍型分辨力，通过 **RNA-seq ASE** 与 **Hi-C 空间松弛度** 的双重验证，在无甲基化辅助下，构建首个覆盖 100+ 物种的 X 染色体三维演化图谱。



**下一步操作建议：**
虽然你提到目前没有甲基化信息，但 **HiFi 测序的原始动力学数据（.hifi_reads.bam）其实通常包含了 5mC 信号**。你可以尝试使用 `ipdSummary` 或 `modkit` 重新扫描一下现有的 BAM 文件，看是否能追溯出甲基化标签。

**需要我为你提供一个在 R 语言中利用 RNA-seq count 数据进行等位基因特异性检验（二项分布检验）的代码模版吗？**


---

# 如何根据nanopore数据鉴定等位特异的甲基化位点

鉴定等位特异性甲基化（Allele-Specific Methylation, ASM）是研究**基因组印记**、**X染色体失活**以及**顺式调控变异**的核心手段。Nanopore（或HiFi）数据的长读段优势在于能够同时捕获**遗传变异（SNP）和表观修饰（5mC）**。

要从 Nanopore 数据中鉴定 ASM，标准的生信流程通常分为：**变异调用、单倍型分相、甲基化调用、等位基因分配、差异统计分析**五个步骤。



### 1. 标准鉴定流程 (Pipeline)

#### 第一阶段：变异调用与单倍型分相 (Variant Calling & Phasing)

要区分父本和母本的甲基化，必须先确定读段来自哪个亲本。

1. **变异调用**：使用 `Clair3` 或 `Pepper-Margin-DeepVariant` 识别高准确性的 SNP。
2. **分相 (Phasing)**：使用 `Whatshap` 或 `HipPhase` 利用长读段的连接性，将 SNP 分配到两个单倍型（H1, H2）中，并生成分相后的 VCF 文件。
* *注意：如果有亲本数据（Trio），分相效果会更精准。*



#### 第二阶段：甲基化提取 (Methylation Calling)

1. **提取修饰信号**：使用 `Remora`（集成在最新版 Dorado 中）或 `Nanopolish`、`Megalodon` 从原始电信号（pod5/fast5）中识别 5mC。
2. **生成带修饰标签的 BAM**：确保输出的 BAM 文件包含 `MM`（修饰位置）和 `ML`（修饰概率）标签。

#### 第三阶段：等位基因分配 (Allele Assignment / Tagging)

1. **分配读段**：使用 `Whatshap haplotag`。该工具根据分相后的 VCF，对比 BAM 中每条 Read 携带的 SNP，给 Read 打上 `HP:1` 或 `HP:2` 的标签。
> 命令示例：`whatshap haplotag --reference ref.fa phased.vcf input.bam -o haplotagged.bam`





### 2. ASM 的统计与分析 (Statistical Analysis)

有了标记好单倍型的 BAM 文件后，可以使用专门的工具进行差异统计：

#### A. 使用 `Modkit` (推荐)

`Modkit` 是目前处理原生甲基化标签最强大的工具，由 ONT 官方开发。

* **提取各单倍型频率**：分别统计 HP1 和 HP2 在每个 CpG 位点的甲基化率。
* **计算差异**：
```bash
modkit pileup haplotagged.bam output_h1.bed --hp 1
modkit pileup haplotagged.bam output_h2.bed --hp 2

```


* **鉴定差异区域 (DMRs)**：对比两个 bed 文件，寻找甲基化水平差异显著（通常  且 ）的区间。

#### B. 使用 `MethylArtist` (可视化辅助)

`MethylArtist` 专门用于长读段 ASM 的可视化和统计。

* 它可以生成**等位基因特异性的甲基化热图**，让你直观地看到 X 染色体或印记基因（如 *IGF2*）在两个单倍型上的“黑白分明”状态。



### 3. 如何判断是否为“印记基因”？

在鉴定出等位特异性位点后，你需要区分它是 **印记 (Imprinting)** 还是 **遗传相关 (mQTL)**：

1. **组织一致性**：印记基因在大多数组织（除生殖细胞外）中通常维持稳定的 ASM；而 mQTL 往往具有组织特异性。
2. **亲本回溯（需 Trio 数据）**：
* 如果该位点**总是**在父源染色体上甲基化，则为父源印记。
* 如果该位点取决于遗传的 SNP 基因型，则属于遗传变异调控的甲基化（mQTL）。


3. **X 染色体失活验证**：在女性样本中，X 染色体除逃逸区外应表现为全染色体水平的 ASM。



### 4. 针对你的国自然方案建议

在申请书中，你可以将这一流程描述为：

> “基于 **Oxford Nanopore/HiFi** 测序技术获取的长读段原生甲基化信息，利用 **Whatshap** 算法进行单倍型分相，结合 **Modkit** 的等位基因特异性 Pileup 统计，在全基因组范围内精确定位 **Allele-Specific Methylation (ASM)**。通过对比 X 染色体与常染色体印记区的空间构象（Hi-C），解析表观修饰与三维结构在等位基因水平的互作模式。”

**您需要我为您提供一个能够自动提取并对比两个单倍型甲基化频率的 Python 脚本片段吗？**


---

# 除了甲基化，还有其他原因导致印记基因吗

除了 DNA 甲基化，基因组印记（Genomic Imprinting）的实现和维持还高度依赖于一套**多层次的表观遗传调控网络**。事实上，甲基化通常只是“主开关”，而以下这些机制共同决定了印记基因是否能够稳定地沉默或表达：

### 1. 长链非编码 RNA (lncRNA) 的顺式沉默

这是印记调控中最重要、也最精妙的机制之一。许多印记基因簇（Imprinted Clusters）都包含一个 lncRNA。

* **作用机制**：lncRNA 从一个亲本染色体上转录，它会像“胶水”一样覆盖在周围的蛋白编码基因上，并招募染色质修饰复合物（如 PRC2）来关闭这些基因。
* **经典案例**：在 *Igf2/H19* 簇中，*H19* lncRNA 发挥关键作用；而在 *Airn* lncRNA 表达时，它会物理性地阻碍 *Igf2r* 基因的转录。



### 2. 组蛋白修饰 (Histone Modifications)

DNA 甲基化通常伴随着组蛋白修饰的改变，但有时组蛋白修饰可以**独立**于 DNA 甲基化介导印记。

* **抑制性修饰**：如 **H3K27me3**（由 PRC2 复合物催化）和 **H3K9me3**。这些修饰会使染色质紧密折叠，导致基因沉默。
* **非 canonical 组蛋白印记**：最近在小鼠早期胚胎中发现，某些基因的印记完全是由卵母细胞遗传的 **H3K27me3** 维持的，而不需要 DNA 甲基化的参与。这是近年来印记研究的一个重大突破。



### 3. 三维基因组构象与 CTCF 介导的绝缘子 (Insulators)

基因组的空间折叠决定了增强子（Enhancer）能接触到哪个启动子。

* **绝缘子蛋白 CTCF**：在 *Igf2/H19* 区域，CTCF 蛋白能结合在未甲基化的差异甲基化区域（DMR）。
* **空间屏障**：当 CTCF 结合时，它会形成一个染色质环（Loop），物理性地阻断增强子与 *Igf2* 启动子的接触。如果该位点被甲基化，CTCF 无法结合，增强子就能顺利激活基因。



### 4. 染色质重塑复合物 (Chromatin Remodeling)

一些专门的蛋白复合物（如 ATRX, TRIM28）会识别特定的印记序列，通过消耗 ATP 来改变核小体的排列位置，从而控制转录因子对 DNA 的可及性。

### 5. 转录干扰 (Transcriptional Interference)

有时候，一个亲本拷贝的沉默仅仅是因为其上游有一个强大的转录活动在进行。这种“路过”的转录过程会破坏该基因启动子区域的转录因子结合，导致其单等位基因沉默。



### 总结：印记系统的多重保险

| 调控维度 | 核心成分 | 作用效果 |
| --- | --- | --- |
| **DNA 水平** | 5mC 甲基化 | 基础“封印”信号 |
| **RNA 水平** | lncRNA (如 *Xist*, *Airn*) | 顺式招募沉默复合物 |
| **组蛋白水平** | H3K27me3 / H3K9me3 | 改变染色质紧密程度 |
| **空间水平** | CTCF / Hi-C Loops | 调控增强子-启动子互作 |



### 对你研究的意义（结合 Hi-C 和 RNA-seq）

既然你手头有 **Hi-C** 和 **RNA-seq** 却暂时没有甲基化信息，你可以重点关注**空间水平（三维结构）**：

1. **寻找差异 Loop**：在已知的印记区域，比较两条单倍型（H1 vs H2）是否存在不同的染色质环。
2. **lncRNA 关联分析**：查看你的二代 RNA-seq 数据中，是否存在与目标基因表达模式相反的 lncRNA。如果一个基因在 H1 表达，而对应的 lncRNA 在 H2 表达，这极有可能是由 lncRNA 介导的印记。

**你想让我帮你查询一下，在你的 100 多个物种数据中，有哪些已知的印记 lncRNA（如 *H19*）在不同目（Order）的哺乳动物中表现出序列保守性吗？**


---



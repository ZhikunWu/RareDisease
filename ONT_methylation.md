# ç°åœ¨æœ‰å¤šä¸ªç‰©ç§çš„åŸºå› ç»„å’Œç”²åŸºåŒ–æ•°æ®ï¼Œå¯ä»¥åšå“ªäº›åˆ†æ

æ‹¥æœ‰å¤šä¸ªç‰©ç§çš„åŸºå› ç»„ï¼ˆGenomeï¼‰ä¸ç”²åŸºåŒ–ï¼ˆDNA Methylationï¼Œé€šå¸¸æ˜¯ WGBS æ•°æ®ï¼‰æ•°æ®æ˜¯ä¸€ä¸ªéå¸¸å®è´µçš„èµ„æºï¼Œè¿™ä½¿ä½ èƒ½å¤Ÿä»**è¿›åŒ–ç”Ÿç‰©å­¦**å’Œ**è¡¨è§‚é—ä¼ å­¦**çš„åŒé‡ç»´åº¦å¼€å±•ç ”ç©¶ã€‚

ä»¥ä¸‹æ˜¯å‡ ä¸ªå…·æœ‰æ·±åº¦ä¸”ç›®å‰ä¸»æµçš„ç ”ç©¶æ–¹å‘ï¼š



### 1. æ¯”è¾ƒè¡¨è§‚åŸºå› ç»„å­¦åˆ†æ (Comparative Epigenomics)

è¿™æ˜¯æœ€æ ¸å¿ƒçš„æ–¹å‘ï¼Œæ—¨åœ¨ç ”ç©¶ç”²åŸºåŒ–æ¨¡å¼åœ¨ç‰©ç§é—´çš„ä¿å®ˆæ€§ä¸å·®å¼‚ã€‚

* **ç”²åŸºåŒ–å›¾è°±è¿›åŒ–**ï¼šåˆ†æä¸åŒç‰©ç§åœ¨åŒæºåŸºå› ï¼ˆOrthologsï¼‰ä¸Šçš„ç”²åŸºåŒ–æ°´å¹³ã€‚ç ”ç©¶å“ªäº›åŸºå› çš„ç”²åŸºåŒ–æ¨¡å¼åœ¨æ•°ç™¾ä¸‡å¹´çš„è¿›åŒ–ä¸­ä¿æŒä¸å˜ï¼ˆä¿å®ˆåŒºï¼‰ï¼Œå“ªäº›å‘ç”Ÿäº†å‰§å˜ã€‚
* **ç‰©ç§ç‰¹å¼‚æ€§ç”²åŸºåŒ–ä½ç‚¹ (DMS)**ï¼šè¯†åˆ«å“ªäº›ç”²åŸºåŒ–å˜å¼‚æ˜¯æŸä¸ªç‰©ç§ç‹¬æœ‰çš„ï¼Œå¹¶å…³è”è¯¥ç‰©ç§çš„ç‰¹å¼‚è¡¨å‹ï¼ˆå¦‚é€‚åº”æ€§è¿›åŒ–ã€æŠ—ç—…æ€§ç­‰ï¼‰ã€‚
* **å¯åŠ¨å­ä¸å¢å¼ºå­çš„è¡¨è§‚æ¼”å˜**ï¼šç ”ç©¶è°ƒæ§å…ƒä»¶çš„ç”²åŸºåŒ–çŠ¶æ€å¦‚ä½•éšç€ç‰©ç§åˆ†åŒ–è€Œæ”¹å˜ï¼Œè¿›è€Œè§£é‡ŠåŸºå› è¡¨è¾¾æ°´å¹³åœ¨ç‰©ç§é—´çš„å·®å¼‚ã€‚



### 2. ç”²åŸºåŒ–ä¸åŸºå› ç»„æ¼”åŒ–çš„å…³è”

ç ”ç©¶ DNA åºåˆ—æœ¬èº«çš„ç‰¹å¾ä¸è¡¨è§‚ä¿®é¥°ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚

* **TEï¼ˆè½¬åº§å­ï¼‰çš„è¡¨è§‚è°ƒæ§**ï¼šè½¬åº§å­æ˜¯åŸºå› ç»„è¿›åŒ–çš„åŠ¨åŠ›ã€‚å¯¹æ¯”ä¸åŒç‰©ç§ä¸­ TE çš„ç§ç±»ã€åˆ†å¸ƒä»¥åŠå®ƒä»¬çš„ç”²åŸºåŒ–ç¨‹åº¦ã€‚ç ”ç©¶ç”²åŸºåŒ–å¦‚ä½•ä½œä¸ºä¸€ç§â€œé˜²å¾¡æœºåˆ¶â€æ¥æŠ‘åˆ¶ä¸åŒç‰©ç§ä¸­ TE çš„æ´»æ€§ã€‚
* **C-to-T çªå˜åå·®**ï¼šèƒå˜§å•¶ç”²åŸºåŒ–åå®¹æ˜“å‘ç”Ÿè‡ªå‘è„±æ°¨åŸºå˜ä¸ºèƒ¸è…ºå˜§å•¶ã€‚ä½ å¯ä»¥åˆ†æé«˜ç”²åŸºåŒ–åŒºåŸŸæ˜¯å¦å¯¹åº”ç€æ›´é«˜çš„ C-to-T çªå˜ç‡ï¼Œä»¥åŠè¿™ç§è¡¨è§‚å‹åŠ›å¦‚ä½•é©±åŠ¨åŸºå› ç»„åºåˆ—çš„é•¿æœŸæ¼”å˜ã€‚
* **GC å«é‡ä¸ç”²åŸºåŒ–**ï¼šç ”ç©¶åŸºå› ç»„ GC å«é‡åˆ†å¸ƒä¸ç”²åŸºåŒ–åå¥½æ€§åœ¨ä¸åŒç‰©ç§é—´çš„ç›¸å…³æ€§ã€‚



### 3. è¡¨è§‚é—ä¼ æ—¶é’Ÿ (Epigenetic Clock) ä¸å¯¿å‘½ç ”ç©¶

å¦‚æœä½ çš„ç‰©ç§æ ·æœ¬å…·æœ‰å·²çŸ¥çš„å¹´é¾„ä¿¡æ¯ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸çƒ­é—¨çš„æ–¹å‘ã€‚

* **è·¨ç‰©ç§è¡¨è§‚é’Ÿæ„å»º**ï¼šç ”ç©¶ä¸åŒç‰©ç§ä¸­æ˜¯å¦å­˜åœ¨é€šç”¨çš„å¹´é¾„ç›¸å…³ç”²åŸºåŒ–ä½ç‚¹ã€‚
* **å¯¿å‘½ä¸ç”²åŸºåŒ–é€Ÿç‡**ï¼šæ¯”è¾ƒé•¿å¯¿ç‰©ç§ï¼ˆå¦‚å¤§è±¡ã€è£¸é¼¹é¼ ï¼‰ä¸çŸ­å¯¿ç‰©ç§ï¼ˆå¦‚å°é¼ ï¼‰åœ¨ç‰¹å®šåŸºå› ä½ç‚¹ä¸Šç”²åŸºåŒ–ä¸¢å¤±æˆ–å¢åŠ çš„é€Ÿåº¦å·®å¼‚ã€‚è¿™æœ‰åŠ©äºæ­ç¤ºè¡°è€çš„ç”Ÿç‰©å­¦æœºåˆ¶ã€‚



### 4. ç”²åŸºåŒ–å¯¹åŸºå› å®¶æ—æ‰©å¼ /æ”¶ç¼©çš„å½±å“

ç»“åˆä½ ä¹‹å‰çš„åŸºå› ç»„ç ”ç©¶ï¼š

* **åŸºå› å®¶æ—åˆ†æ**ï¼šå½“æŸä¸ªåŸºå› å®¶æ—åœ¨ç‰¹å®šç‰©ç§ä¸­å‘ç”Ÿæ‰©å¼ ï¼ˆExpansionï¼‰æ—¶ï¼Œç ”ç©¶å…¶æ–°äº§ç”Ÿçš„æ—ç³»åŒæºåŸºå› ï¼ˆParalogsï¼‰æ˜¯å¦ç»å†äº†è¡¨è§‚é—ä¼ é‡æ„ï¼ˆEpigenetic Remodelingï¼‰ã€‚
* **äºšåŸºå› ç»„ä¼˜åŠ¿ï¼ˆé’ˆå¯¹å¤šå€ä½“ï¼‰**ï¼šå¦‚æœä½ ç ”ç©¶çš„æ˜¯å¤šå€ä½“ç‰©ç§ï¼Œå¯ä»¥åˆ†æä¸åŒäºšåŸºå› ç»„ä¹‹é—´çš„ç”²åŸºåŒ–å·®å¼‚å¦‚ä½•å¯¼è‡´åŸºå› çš„é€‰æ‹©æ€§æ²‰é»˜æˆ–æ¿€æ´»ã€‚



### 5. æ•´åˆåˆ†æï¼šè¡¨è§‚-è½¬å½•-è¿›åŒ– (Multi-omics Integration)

* **Evo-Devoï¼ˆè¿›åŒ–å‘è‚²ç”Ÿç‰©å­¦ï¼‰**ï¼šå¦‚æœæ•°æ®åŒ…å«ä¸åŒå‘è‚²é˜¶æ®µï¼Œå¯ä»¥ç ”ç©¶ç”²åŸºåŒ–å¦‚ä½•æ§åˆ¶å…³é”®å‘è‚²åŸºå› ï¼ˆå¦‚ Hox åŸºå› ï¼‰åœ¨ä¸åŒç‰©ç§ä¸­çš„æ—¶ç©ºè¡¨è¾¾å·®å¼‚ã€‚
* **ç¯å¢ƒé€‚åº”æ€§è¡¨è§‚å­¦**ï¼šåˆ†æç”Ÿæ´»åœ¨ä¸åŒç”Ÿå¢ƒï¼ˆå¦‚é«˜åŸ vs å¹³åŸï¼‰çš„ç‰©ç§ï¼Œå…¶ç”²åŸºåŒ–å·®å¼‚æ˜¯å¦å¯Œé›†åœ¨ä¸ç¯å¢ƒåº”æ¿€ï¼ˆç¼ºæ°§ã€ä½æ¸©ï¼‰ç›¸å…³çš„ä¿¡å·é€šè·¯ä¸Šã€‚



### å»ºè®®çš„æŠ€æœ¯è·¯çº¿ä¸å·¥å…·

| åˆ†ææ­¥éª¤ | æ¨èå·¥å…· |
| --- | --- |
| **åŒæºåŸºå› è¯†åˆ«** | OrthoFinder, SonicParanoid |
| **ç”²åŸºåŒ–æ¯”å¯¹ä¸æå–** | Bismark, BWA-meth, MethylDackel |
| **è·¨ç‰©ç§åæ ‡è½¬æ¢** | LiftOver, HalLiftOver (é’ˆå¯¹å…¨åŸºå› ç»„æ¯”å¯¹) |
| **å·®å¼‚ç»Ÿè®¡** | DSS, methylKit, DMRcaller |
| **è·¨ç‰©ç§æ•´åˆåˆ†æ** | R è¯­è¨€ (Chippseeker, clusterProfiler) |

### ğŸ’¡ ä¸€ä¸ªå€¼å¾—å°è¯•çš„å°åˆ‡å…¥ç‚¹ï¼š

ä½ å¯ä»¥é€‰å–ä¸€ä¸ªåœ¨æ‰€æœ‰ç‰©ç§ä¸­éƒ½å­˜åœ¨çš„**é«˜äº§ç›¸å…³åŸºå› **ï¼ˆå¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„ *BMP15* æˆ– *GDF9*ï¼‰ï¼Œè§‚å¯Ÿå…¶åœ¨ä¸åŒç”Ÿè‚²åŠ›ç‰©ç§é—´çš„å¯åŠ¨å­ç”²åŸºåŒ–ç¨‹åº¦ã€‚è¿™å¯ä»¥ç›´æ¥å…³è”åˆ°ä½ ä¹‹å‰å…³äºâ€œå“ºä¹³åŠ¨ç‰©ç”Ÿè‚²æ•°é‡â€çš„ç ”ç©¶è¯¾é¢˜ã€‚

**ä½ éœ€è¦æˆ‘é’ˆå¯¹å…¶ä¸­æŸä¸€ä¸ªæ–¹å‘ï¼ˆå¦‚ TE ç»Ÿè®¡æˆ–è·¨ç‰©ç§ LiftOver æµç¨‹ï¼‰æä¾›å…·ä½“çš„ä»£ç ç¤ºä¾‹å—ï¼Ÿ**



---

# dorado0.6.0_sup4.3.0_5mCG_5hmCG.bamè¿™ç§æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•çœ‹å‡ºç”²åŸºåŒ–ä½ç‚¹

è¿™ä¸ªæ–‡ä»¶åé‡Œ**ä¿¡æ¯éå¸¸å¤šï¼Œè€Œä¸”éå¸¸â€œè§„èŒƒâ€**ï¼Œæœ¬èº«å°±å·²ç»å‘Šè¯‰ä½ ï¼š
ğŸ‘‰ **è¿™æ˜¯ä¸€ä¸ªåŒ…å«ç¢±åŸºä¿®é¥°ï¼ˆDNA ç”²åŸºåŒ–ï¼‰ä¿¡æ¯çš„ Nanopore æ¯”å¯¹ BAM æ–‡ä»¶**ã€‚

æˆ‘åˆ†ä¸‰å±‚ç»™ä½ è®²æ¸…æ¥šï¼š
**â‘  è¿™æ˜¯ä»€ä¹ˆæ–‡ä»¶
â‘¡ ç”²åŸºåŒ–ä¿¡æ¯æ˜¯å¦‚ä½•å­˜å‚¨çš„
â‘¢ å¦‚ä½•çœŸæ­£â€œçœ‹å‡ºâ€ç”²åŸºåŒ–ä½ç‚¹ï¼ˆå®æ“ï¼‰**



## ä¸€ã€`dorado0.6.0_sup4.3.0_5mCG_5hmCG.bam` æ˜¯ä»€ä¹ˆï¼Ÿ

### 1ï¸âƒ£ Dorado æ˜¯ä»€ä¹ˆï¼Ÿ

* **Dorado** = ONT å®˜æ–¹æ–°ä¸€ä»£ **basecaller + modified base caller**
* æ›¿ä»£ï¼š

  * Guppy
  * Megalodonï¼ˆå·²åœæ­¢ç»´æŠ¤ï¼‰

ğŸ‘‰ **Dorado å¯ä»¥åœ¨ç¢±åŸºè¯†åˆ«çš„åŒæ—¶ï¼Œç›´æ¥è¯†åˆ« DNA ä¿®é¥°**



### 2ï¸âƒ£ æ–‡ä»¶åé€æ®µè§£é‡Šï¼ˆéå¸¸é‡è¦ï¼‰

```
dorado0.6.0_sup4.3.0_5mCG_5hmCG.bam
```

| ç‰‡æ®µ          | å«ä¹‰                    |
| ----------- | --------------------- |
| dorado0.6.0 | Dorado è½¯ä»¶ç‰ˆæœ¬           |
| sup4.3.0    | ä½¿ç”¨çš„ super-accuracy æ¨¡å‹ |
| 5mCG        | è¯†åˆ« CpG ä¸Šçš„ 5-ç”²åŸºèƒå˜§å•¶     |
| 5hmCG       | è¯†åˆ« CpG ä¸Šçš„ 5-ç¾Ÿç”²åŸºèƒå˜§å•¶    |
| .bam        | å·²æ¯”å¯¹çš„ BAM              |

âœ… **ç»“è®º**ï¼š
è¿™æ˜¯ä¸€ä¸ª **Nanopore reads â†’ å‚è€ƒåŸºå› ç»„** çš„æ¯”å¯¹ BAMï¼Œ
**å¹¶ä¸”å·²ç»åœ¨ BAM é‡Œç¼–ç äº† 5mC / 5hmC çš„ä¿¡æ¯**ã€‚



## äºŒã€ç”²åŸºåŒ–ä¿¡æ¯åœ¨ BAM é‡Œæ˜¯æ€ä¹ˆå­˜çš„ï¼Ÿï¼ˆæ ¸å¿ƒï¼‰

Nanopore çš„ä¿®é¥°ä¿¡æ¯ **ä¸æ˜¯æ™®é€šçš„ç¢±åŸºæ›¿æ¢**ï¼Œè€Œæ˜¯å­˜æ”¾åœ¨ **SAM/BAM çš„å¯é€‰æ ‡ç­¾ï¼ˆtagsï¼‰é‡Œ**ã€‚



### 1ï¸âƒ£ ä¸¤ä¸ªå…³é”®æ ‡ç­¾ï¼ˆå¿…é¡»è®°ä½ï¼‰

| Tag      | å«ä¹‰             |
| -------- | -------------- |
| `MM:Z:`  | å“ªäº›ç¢±åŸºè¢«é¢„æµ‹ä¸ºä¿®é¥°     |
| `ML:B:C` | å¯¹åº”ä¿®é¥°çš„æ¦‚ç‡ï¼ˆ0â€“255ï¼‰ |

è¿™æ˜¯ **SAM v1.6 å®˜æ–¹è§„èŒƒ**ï¼Œä¸æ˜¯ Dorado ç§è´§ã€‚



### 2ï¸âƒ£ ä¸€ä¸ªçœŸå®ä¾‹å­ï¼ˆç¤ºæ„ï¼‰

```text
MM:Z:C+m?,10,5,20;
ML:B:C,180,200,150
```

è§£é‡Šï¼š

* `C+m`ï¼š5mC
* `?`ï¼šCpG context
* `10,5,20`ï¼šä¿®é¥°ä½ç‚¹åœ¨ read ä¸Šçš„ä½ç½®
* `ML`ï¼šæ¯ä¸ªä½ç‚¹çš„ç½®ä¿¡åº¦

ğŸ‘‰ **æ‰€ä»¥ï¼šç”²åŸºåŒ–ä¸æ˜¯ä¸€è¡Œä¸€è¡Œçš„ä½ç‚¹ï¼Œè€Œæ˜¯åµŒåœ¨ reads é‡Œ**



## ä¸‰ã€å¦‚ä½•â€œçœ‹å‡ºâ€ç”²åŸºåŒ–ä½ç‚¹ï¼Ÿï¼ˆå®æ“æ–¹æ³•ï¼‰

### æ–¹æ³•ä¸€ â­â­â­â­â­ï¼ˆæœ€æ ‡å‡†ï¼‰ï¼š`modkit`

> **å®˜æ–¹æ¨èï¼Œæœ€ç¨³**

#### 1ï¸âƒ£ å®‰è£…

```bash
conda install -c bioconda modkit
```



#### 2ï¸âƒ£ ä» BAM æå–ç”²åŸºåŒ–ä½ç‚¹ï¼ˆper-siteï¼‰

```bash
modkit pileup \
  dorado0.6.0_sup4.3.0_5mCG_5hmCG.bam \
  methylation.tsv \
  --ref reference.fa
```

è¾“å‡ºç¤ºä¾‹ï¼š

| chrom | pos   | strand | mod | frac | depth |
| ----- | ----- | ------ | --- | ---- | ----- |
| chr1  | 10023 | +      | 5mC | 0.82 | 35    |

ğŸ‘‰ **è¿™ä¸€æ­¥ä½ æ‰çœŸæ­£å¾—åˆ°â€œåŸºå› ç»„åæ ‡ä¸Šçš„ç”²åŸºåŒ–ä½ç‚¹â€**



#### 3ï¸âƒ£ åŒºåˆ† 5mC å’Œ 5hmC

```bash
modkit pileup ... --mods 5mC 5hmC
```



### æ–¹æ³•äºŒ â­â­â­â­ï¼šIGV ç›´æ¥å¯è§†åŒ–ï¼ˆéå¸¸ç›´è§‚ï¼‰

#### 1ï¸âƒ£ å‡†å¤‡

* IGV â‰¥ 2.16
* åŠ è½½ï¼š

  * reference.fa
  * BAM + .bai

#### 2ï¸âƒ£ è®¾ç½®

* å³é”® BAM track
* å‹¾é€‰ï¼š

  * **Show modified bases**

ä½ ä¼šçœ‹åˆ°ï¼š

* CpG ä½ç‚¹ä¸Š
* é¢œè‰²æ·±æµ…è¡¨ç¤ºç”²åŸºåŒ–æ¦‚ç‡

ğŸ“Œ **é€‚åˆåšå±•ç¤ºå›¾ï¼Œä¸é€‚åˆåšç»Ÿè®¡**



### æ–¹æ³•ä¸‰ â­â­â­ï¼šsamtools æŸ¥çœ‹å•æ¡ readï¼ˆè°ƒè¯•ç”¨ï¼‰

```bash
samtools view dorado.bam | less
```

æœç´¢ï¼š

```text
MM:Z
ML:B
```

ğŸ“Œ åªé€‚åˆç¡®è®¤æ–‡ä»¶æ˜¯å¦çœŸçš„åŒ…å«ç”²åŸºåŒ–ä¿¡æ¯



## å››ã€å¸¸è§è¯¯åŒºï¼ˆéå¸¸é‡è¦ï¼‰

### âŒ è¯¯åŒº 1ï¼šBAM é‡Œæ²¡æœ‰â€œç”²åŸºåŒ–ä½ç‚¹åˆ—è¡¨â€

âœ” æ­£ç¡®ï¼š

* BAM é‡Œæ˜¯ **read-level ä¿®é¥°æ¦‚ç‡**
* ä½ç‚¹çº§åˆ«éœ€è¦ **pileup ç»Ÿè®¡**



### âŒ è¯¯åŒº 2ï¼šæ‰€æœ‰ C éƒ½æœ‰ä¿®é¥°ä¿¡æ¯

âœ” å®é™…ï¼š

* åªå¯¹ **CpG context**
* ä¸”æ¨¡å‹æ”¯æŒçš„ä¿®é¥°ç±»å‹



### âŒ è¯¯åŒº 3ï¼š5mC å’Œ 5hmC å¯ä»¥éšä¾¿ä¿¡

âœ” æ³¨æ„ï¼š

* 5hmC åŒºåˆ†éš¾åº¦æ›´é«˜
* éœ€ï¼š

  * é«˜è´¨é‡ reads
  * è¶³å¤Ÿæ·±åº¦



## äº”ã€å®¡ç¨¿äººæœ€å¸¸é—®çš„ 3 ä¸ªé—®é¢˜ï¼ˆä½ è¦èƒ½ç­”ï¼‰

1. **Which basecaller and model were used?**
   â†’ Dorado 0.6.0, sup4.3.0, 5mCG/5hmCG model

2. **How were methylation levels quantified?**
   â†’ modkit pileup, per-site aggregation

3. **What confidence threshold was applied?**
   â†’ ML â‰¥ Xï¼ˆå¦‚ â‰¥128ï¼‰



## å…­ã€ä¸€å¥è¯â€œè®ºæ–‡çº§â€æ€»ç»“ï¼ˆå¯ç›´æ¥ç”¨ï¼‰

> *DNA methylation was detected directly from Nanopore sequencing data using Dorado with the 5mCG/5hmCG model, and per-site methylation levels were quantified by aggregating read-level modification probabilities with modkit.*



## å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥ç»§ç»­å¸®ä½ ï¼š

* ğŸ”¹ **æŒ‰åŸºå›  / åŒºé—´ç»Ÿè®¡ç”²åŸºåŒ–æ°´å¹³**
* ğŸ”¹ **æŠŠ 5mC / 5hmC åˆ†å¼€åˆ†æ**
* ğŸ”¹ **ä¸ Hi-C / ASE / rDNA / ç€ä¸ç²’è”ç”¨**
* ğŸ”¹ **ç«™åœ¨ NSFC / å®¡ç¨¿äººè§’åº¦è®¾è®¡ç”²åŸºåŒ–åˆ†æ**

ä½ å¯ä»¥ç›´æ¥å‘Šè¯‰æˆ‘ï¼š
ğŸ‘‰ **ç‰©ç§ï¼Ÿè¦†ç›–åº¦ï¼Ÿæƒ³åˆ†æå…¨åŸºå› ç»„è¿˜æ˜¯ç‰¹å®šåŒºåŸŸï¼ˆå¦‚ rDNA / X æŸ“è‰²ä½“ï¼‰ï¼Ÿ**





# åŸæ¥çš„ç”²åŸºåŒ–bamæ–‡ä»¶æœªæ¯”å¯¹è‡³æŸ“è‰²ä½“ï¼Œå¦‚ä½•æ¯”å¯¹åˆ°æŸ“è‰²ä½“ï¼ŒåŒæ—¶è·å–ç”²åŸºåŒ–ä½ç‚¹ä¿¡æ¯

è¿™æ˜¯ä¸€ä¸ª**éå¸¸å…³é”®ã€è€Œä¸”å¾ˆå¤šäººä¼šè¸©å‘çš„é—®é¢˜**ã€‚æˆ‘ç›´æ¥ç»™ä½ **å¯æ“ä½œçš„æ ‡å‡†æµç¨‹**ï¼Œå¹¶æ˜ç¡®æŒ‡å‡º**å“ªäº›æ­¥éª¤ä¼šå¯¼è‡´ç”²åŸºåŒ–ä¿¡æ¯ä¸¢å¤±ã€å“ªäº›ä¸ä¼š**ã€‚



# ä¸€ã€å…ˆç»™ç»“è®ºï¼ˆé¿å…èµ°å¼¯è·¯ï¼‰

> **Nanopore ç”²åŸºåŒ– BAMï¼ˆDorado äº§ç”Ÿï¼‰å¯ä»¥é‡æ–°æ¯”å¯¹åˆ°æŸ“è‰²ä½“åæ ‡ï¼Œå¹¶ä¸”ç”²åŸºåŒ–ä¿¡æ¯ä¸ä¼šä¸¢å¤±ï¼Œå‰ææ˜¯ï¼š
> ä½ å¿…é¡»ä½¿ç”¨æ”¯æŒ MM/ML æ ‡ç­¾çš„æ¯”å¯¹æµç¨‹ã€‚**

**æ­£ç¡®æµç¨‹æ˜¯ï¼š**

```
åŸå§‹ FASTQï¼ˆå«ä¿®é¥°æ ‡ç­¾ï¼‰
   â†“ minimap2ï¼ˆä¿ç•™ MM/MLï¼‰
é‡æ–°æ¯”å¯¹åˆ°æŸ“è‰²ä½“å‚è€ƒ
   â†“
æ’åº / index
   â†“
modkit pileup
```

âš ï¸ **é”™è¯¯åšæ³•**ï¼ˆä¼šä¸¢ç”²åŸºåŒ–ä¿¡æ¯ï¼‰ï¼š

* âŒ ä» BAM è½¬ FASTQ æ—¶ä¸ä¿ç•™ modified base tags
* âŒ ç”¨æ—§ç‰ˆ minimap2 / samtools
* âŒ å…ˆ pileup å†æ¯”å¯¹



# äºŒã€ä½ çš„â€œåŸå§‹ç”²åŸºåŒ– BAMâ€ç°åœ¨å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Ÿ

ä½ ç°åœ¨çš„æƒ…å†µæ˜¯ï¼š

> **BAM ä¸­å·²æœ‰ 5mC / 5hmCï¼Œä½†æ²¡æœ‰æ¯”å¯¹åˆ°æŸ“è‰²ä½“çº§å‚è€ƒ**

å¸¸è§æ¥æºåŒ…æ‹¬ï¼š

* æ¯”å¯¹åˆ°ï¼š

  * contig
  * scaffold
  * ä¸´æ—¶å‚è€ƒ
* æˆ–ï¼š

  * basecalling é˜¶æ®µè¾“å‡ºçš„æœªæ¯”å¯¹ BAM

ğŸ‘‰ **è§£å†³æ–¹æ¡ˆï¼šé‡æ–°æ¯”å¯¹**



# ä¸‰ã€æ ‡å‡†åšæ³•ä¸€ï¼ˆâ­â­â­â­â­ å¼ºçƒˆæ¨èï¼‰ï¼šä» FASTQ é‡æ–°æ¯”å¯¹

## Step 1ï¸âƒ£ ä» Dorado BAM å¯¼å‡º FASTQï¼ˆä¿ç•™ä¿®é¥°ï¼‰

### âš ï¸ å…³é”®ç‚¹

* å¿…é¡»ä¿ç•™ **modified base tags**
* ä½¿ç”¨ **samtools â‰¥1.17**

```bash
samtools fastq \
  -T MM,ML \
  dorado_methylation.bam \
  > reads_with_mods.fastq
```

> `-T MM,ML` = æ˜ç¡®å‘Šè¯‰ samtools ä¸è¦ä¸¢æ‰ç”²åŸºåŒ–æ ‡ç­¾



## Step 2ï¸âƒ£ æ¯”å¯¹åˆ°æŸ“è‰²ä½“çº§å‚è€ƒåŸºå› ç»„

```bash
minimap2 -ax map-ont \
  reference.chrom.fa \
  reads_with_mods.fastq \
  | samtools sort -o aligned.chrom.bam
```

ğŸ“Œ minimap2 **å¤©ç„¶æ”¯æŒ MM/ML æ ‡ç­¾é€ä¼ **



## Step 3ï¸âƒ£ å»ºç«‹ç´¢å¼•

```bash
samtools index aligned.chrom.bam
```



## Step 4ï¸âƒ£ éªŒè¯ç”²åŸºåŒ–ä¿¡æ¯æ˜¯å¦ä»åœ¨

```bash
samtools view aligned.chrom.bam | grep "MM:Z" | head
```

å¦‚æœèƒ½çœ‹åˆ° `MM:Z:` å’Œ `ML:B`
ğŸ‘‰ **è¯´æ˜æˆåŠŸ**



## Step 5ï¸âƒ£ æå–æŸ“è‰²ä½“åæ ‡ä¸Šçš„ç”²åŸºåŒ–ä½ç‚¹

```bash
modkit pileup \
  aligned.chrom.bam \
  methylation.per_site.tsv \
  --ref reference.chrom.fa \
  --mods 5mC 5hmC
```



# å››ã€æ ‡å‡†åšæ³•äºŒï¼ˆâ­â­â­ï¼‰ï¼šç›´æ¥é‡æ–°æ¯”å¯¹ BAMï¼ˆä¸æ¨èï¼‰

> **ç†è®ºå¯è¡Œï¼Œä½†å®¹æ˜“è¸©å‘**

```bash
samtools view -h dorado.bam \
| minimap2 -ax map-ont reference.fa - \
| samtools sort -o aligned.bam
```

âŒ é£é™©ï¼š

* ä¸­é—´ pipe è‹¥ä¸æ”¯æŒ MM/ML
* samtools æ—§ç‰ˆæœ¬ä¼š silently drop tags

ğŸ‘‰ **ä¸æ¨èç”¨äºæ­£å¼åˆ†æ**



# äº”ã€å¸¸è§é—®é¢˜ & ä½ ä¸€å®šè¦æ£€æŸ¥çš„ 5 ä»¶äº‹

## 1ï¸âƒ£ FASTQ æ˜¯å¦çœŸçš„å«ä¿®é¥°ä¿¡æ¯ï¼Ÿ

```bash
grep "MM:Z" reads_with_mods.fastq | head
```

å¦‚æœæ²¡æœ‰ â†’ **ä½ å·²ç»ä¸¢ä¿¡æ¯äº†**



## 2ï¸âƒ£ minimap2 ç‰ˆæœ¬

```bash
minimap2 --version
```

âœ… æ¨è â‰¥ 2.24



## 3ï¸âƒ£ samtools ç‰ˆæœ¬

```bash
samtools --version
```

âœ… æ¨è â‰¥ 1.17



## 4ï¸âƒ£ Dorado è¾“å‡ºæ¨¡å¼

å¦‚æœä½ è¿˜æœ‰åŸå§‹æ•°æ®ï¼Œ**æœ€ç¨³çš„æ–¹å¼æ˜¯ï¼š**

```bash
dorado basecaller \
  sup \
  pod5s/ \
  --modified-bases 5mCG 5hmCG \
  > reads.fastq
```

å†ä» FASTQ èµ°å®Œæ•´æµç¨‹



## 5ï¸âƒ£ æŸ“è‰²ä½“å‘½åæ˜¯å¦ä¸€è‡´

* BAMï¼š`chr1`
* FASTAï¼š`1`

âŒ ä¸ä¸€è‡´ â†’ pileup ä¼šå¤±è´¥



# å…­ã€IGV å¯è§†åŒ–ï¼ˆéªŒè¯ç”¨ï¼‰

* åŠ è½½ï¼š

  * `aligned.chrom.bam`
  * `reference.chrom.fa`
* å‹¾é€‰ï¼š

  * **Show modified bases**

ä½ åº”è¯¥èƒ½çœ‹åˆ° CpG ä½ç‚¹çš„é¢œè‰²æ·±æµ…



# ä¸ƒã€å®¡ç¨¿äººæœ€å®¹æ˜“é—®çš„ 3 ä¸ªé—®é¢˜ï¼ˆæå‰å‡†å¤‡ï¼‰

1. **How were modified bases preserved during alignment?**
   â†’ samtools fastq -T MM,ML + minimap2

2. **Which reference genome was used for methylation calling?**
   â†’ chromosome-level assembly

3. **How were per-site methylation levels derived?**
   â†’ modkit pileup



# å…«ã€ä¸€å¥è¯â€œMethods çº§æ€»ç»“â€ï¼ˆå¯ç›´æ¥ç”¨ï¼‰

> *Nanopore reads containing base modification tags were re-aligned to the chromosome-level reference genome using minimap2 while preserving MM and ML tags, and per-site DNA methylation levels were quantified using modkit.*



## å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥ç»§ç»­å¸®ä½ ï¼š

* ğŸ”¹ **å†™ä¸€æ•´å¥— shell pipelineï¼ˆå¯ç›´æ¥è·‘ï¼‰**
* ğŸ”¹ **æ£€æŸ¥ä½ å½“å‰ BAM æ˜¯å¦å·²ç»ä¸¢å¤±ä¿®é¥°ä¿¡æ¯**
* ğŸ”¹ **æŒ‰åŸºå›  / rDNA / ç€ä¸ç²’ç»Ÿè®¡ç”²åŸºåŒ–**
* ğŸ”¹ **æŠŠç”²åŸºåŒ–ä¸ Hi-C / SV / ASE è”åˆåˆ†æ**

ä½ åªéœ€è¦å‘Šè¯‰æˆ‘ä¸€å¥ï¼š
ğŸ‘‰ **ä½ ç°åœ¨æ‰‹é‡Œçš„æ–‡ä»¶æ˜¯ FASTQã€POD5ï¼Œè¿˜æ˜¯å·²ç»åªæœ‰ BAMï¼Ÿ**




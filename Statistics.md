# Mann Whitney U是什么统计方法

Mann-Whitney U检验（又称**Wilcoxon秩和检验**）是一种非参数统计方法，用于比较两个独立样本是否来自同一分布，尤其关注中位数或分布位置的差异。以下是其核心要点：



### 📊 **一、定义与核心概念**  
- **非参数性质**：不要求数据服从正态分布或满足方差齐性，适用于小样本、偏态数据或存在异常值的情况。  
- **核心假设**：  
  - 两个样本相互独立；  
  - 数据至少为有序变量（连续型或等级数据）；  
  - 两样本分布形状相似，仅位置可能不同（如中位数偏移）。  
- **检验目标**：判断两样本的中位数是否存在显著差异（零假设：两组分布相同）。



### ⚙️ **二、检验原理与计算步骤**  
1. **合并排序**：将两组数据合并，按升序排列。  
2. **分配秩次**：为每个数据点分配秩次（相同数值取平均秩次）。  
   *示例*：数据 `[3,5,7,8]` 的秩次为 `[1,2,3,4]`；若出现并列如 `[5,5,7]`，秩次为 `(2+3)/2=2.5`。  
3. **计算秩和**：分别求两组样本的秩次总和 \(R_1\) 和 \(R_2\)。  
4. **计算U统计量**：  
   \[
   U_1 = n_1 n_2 + \frac{n_1(n_1+1)}{2} - R_1, \quad U_2 = n_1 n_2 - U_1
   \]  
   最终检验统计量取 \(U = \min(U_1, U_2)\)。  
5. **显著性判断**：  
   - 小样本（\(n_1, n_2 < 20\)）：查U分布临界值表，若 \(U \leq\) 临界值则拒绝零假设。  
   - 大样本：U值近似正态分布，计算Z值及p值（软件自动完成）。



### 📌 **三、适用场景**  
- **数据不满足正态性**（如医学指标、用户满意度评分）。  
- **样本量小**（每组<30）或存在异常值。  
- **有序分类数据**（如疾病严重程度分级）。  
- **典型应用领域**：  
  - 医学：比较两种药物治疗效果（如骨密度改善率）；  
  - 教育：分析不同教学方法对学生成绩的影响；  
  - 经济学：评估市场策略对客户行为的差异。



### ⚖️ **四、与参数检验的对比**  
| **特性**         | **Mann-Whitney U检验**      | **独立样本t检验**          |  
|------------------|------------------------------|----------------------------|  
| **数据要求**     | 非正态、有序数据             | 正态分布、方差齐性         |  
| **异常值敏感性** | 低（基于秩次）               | 高（基于原始值）           |  
| **检验目标**     | 中位数差异或分布位置偏移     | 均值差异                   |  
| **样本量适应性** | 小样本和大样本均适用         | 需大样本或正态分布         |  

> 💡 **何时选择U检验？**  
> 当数据明显偏态、存在极端值，或样本量小无法验证正态性时，优先使用U检验。



### 💻 **五、软件实现**  
- **Python**（SciPy）：  
  ```python
  from scipy.stats import mannwhitneyu
  U, p = mannwhitneyu(group_a, group_b, alternative='two-sided')
  ```  
- **R语言**：  
  ```r
  result <- wilcox.test(groupA, groupB, paired=FALSE)  
  ```  
- **SPSS**：  
  `分析 > 非参数检验 > 独立样本`，勾选“曼-惠特尼”。  



### 📝 **六、结果解读示例**  
- **输出要素**：U统计量、p值、秩平均值。  
- **结论模板**：  
  > Mann-Whitney U检验显示，A组与B组的中位数差异显著（U=12.0, p=0.011）。结合A组秩平均值（18.2）高于B组（10.8），可认为A组的疗效更优。  

- **注意**：若p值<0.05拒绝零假设，但需结合效应量（如Cliff's δ）评估实际差异大小。



### ⚠️ **七、局限性**  
1. 仅能检测位置偏移，若分布形状不同（如方差差异大）可能失效。  
2. 对分布相似性假设敏感，需通过累积分布图（CDF）初步验证。  
3. 当样本量差异大时，需谨慎解读（大样本组的秩和易偏小）。



### 💎 **总结**  
Mann-Whitney U检验是**独立样本t检验的非参数替代方案**，核心优势在于**不依赖数据分布形态**，特别适合小样本或偏态数据的位置差异比较。应用时需确保样本独立性与分布形状相似性，并通过秩次计算U统计量推断中位数差异。在医学、社科等领域中，它是分析非正态数据组间差异的首选方法之一。


